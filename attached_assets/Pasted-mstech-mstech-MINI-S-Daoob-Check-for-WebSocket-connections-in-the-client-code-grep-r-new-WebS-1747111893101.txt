mstech@mstech-MINI-S:~/Daoob$ # Check for WebSocket connections in the client code
grep -r "new WebSocket" client/src/
client/src/hooks/use-websocket.tsx:    const ws = new WebSocket(wsUrl);
mstech@mstech-MINI-S:~/Daoob$ # Check server WebSocket setup
grep -r "WebSocketServer" server/
server/routes.ts:import { WebSocketServer, WebSocket } from "ws";
server/routes.ts:  const wss = new WebSocketServer({ server: httpServer, path: '/ws' });
mstech@mstech-MINI-S:~/Daoob$ # First, identify the file containing the WebSocket client setup
find client/src -type f -exec grep -l "WebSocket" {} \;

# Then edit that file to use the correct WebSocket URL
# For example, if the file is client/src/components/chat/chat-window.tsx:
cat > new-websocket-config.js << 'EOF'
// Replace this:
const protocol = window.location.protocol === 'https:' ? 'wss:' : 'ws:';
const wsUrl = `${protocol}//${window.location.host}/ws`;

// With this:
const wsUrl = `ws://${window.location.hostname}:5000/ws`;
EOF

# Use this as a reference for editing the file
client/src/components/chat/chat-window.tsx
client/src/pages/admin/chat.tsx
client/src/hooks/use-websocket.tsx
mstech@mstech-MINI-S:~/Daoob$ cat > websocket-fix.js << 'EOF'
const http = require('http');
const WebSocket = require('ws');

// Create a simple HTTP server
const server = http.createServer((req, res) => {
  res.writeHead(200, { 'Content-Type': 'text/plain' });
  res.end('WebSocket Server');
});

// Create a WebSocket server attached to the HTTP server
const wss = new WebSocket.Server({ server, path: '/ws' });

// Handle WebSocket connections
wss.on('connection', (ws) => {
  console.log('Client connected to WebSocket');
  
  ws.on('message', (message) => {
    console.log('Received message:', message);
    // Echo the message back
    ws.send(message);
  });
  
  ws.on('close', () => {
    console.log('Client disconnected');
  });
  
  // Send a welcome message
  ws.send(JSON.stringify({ type: 'system', content: 'Connected to WebSocket server' }));
sudo node websocket-fix.js port 443edng on port 443');

changed 1 package, and audited 481 packages in 4s

65 packages are looking for funding
  run `npm fund` for details

7 moderate severity vulnerabilities

To address issues that do not require attention, run:
  npm audit fix

To address all issues (including breaking changes), run:
  npm audit fix --force

Run `npm audit` for details.
[sudo] password for mstech: 
file:///home/mstech/Daoob/websocket-fix.js:1
const http = require('http');
             ^

ReferenceError: require is not defined in ES module scope, you can use import instead
This file is being treated as an ES module because it has a '.js' file extension and '/home/mstech/Daoob/package.json' contains "type": "module". To treat it as a CommonJS script, rename it to use the '.cjs' file extension.
    at file:///home/mstech/Daoob/websocket-fix.js:1:14
    at ModuleJob.run (node:internal/modules/esm/module_job:263:25)
    at async ModuleLoader.import (node:internal/modules/esm/loader:540:24)
    at async asyncRunEntryPointWithESMLoader (node:internal/modules/run_main:117:5)

Node.js v20.19.0
